#include<stdio.h>


unsigned long long RTX[4];

unsigned long long ranval(){
    unsigned long long v1;
  v1 = RTX[0] - ((RTX[1] << 27) | (RTX[1] >> 5));

  RTX[0] = ((RTX[2] << 17) | (RTX[2] >> 15)) ^ RTX[1];
  RTX[1] = RTX[3] + RTX[2];
  RTX[2] = v1 + RTX[3];
  RTX[3] = v1 + RTX[0];
  return RTX[3];    
}


unsigned long long raninit(long long x){
    unsigned long long result;
    RTX[0] = 0xF1EA5EEDLL;
    RTX[3] = x;
    RTX[2] = RTX[3];
    result = RTX;
    RTX[1] = RTX[2];
    unsigned long long  i;
    for ( i = 0LL; i <= 0x13; ++i ){
        result = ranval();
       printf("0x%llx\n",result);
    }
    return result;
}


int main(int argc,char * argv[]){
    long long a=time(0);
    
    raninit(a);
    puts("-----------------------------------------");
    unsigned long long heap=(ranval()%(unsigned long long)(0x10000-8));
    printf("%llx\n",ranval()); // entry

    for(int i = 0 ; i<15 ; i++){
      printf("%llx\n", ranval());
    }
    ranval();
    puts("-----------------------------------------");
    for(int i=0; i < 1000; i++){
      unsigned long long res=(ranval()%(unsigned long long)(0x10000-100));

      if (((heap - res) < 90) && (heap > res)){
        unsigned long long padding = (heap - res);
        int iteration= i;
        puts("-----------------------------------------");
        printf("HEAP:%llu - RES:%llu\n",heap,res);
        puts("-----------------------------------------");
        printf("padding:%llu\n",padding);
        printf("number_iterations:%d\n",iteration);
        break;
      }else if( (res >= heap) && ( (res-heap) <=32 )){
        unsigned long long padding = (res - heap);
        int iteration= i;
        puts("-----------------------------------------");
        printf("HEAP:%llu - RES:%llu\n",heap,res);
        puts("-----------------------------------------");
        printf("padding:%llu\n",padding);
        printf("number_iterations:%d\n",iteration);
        break;
      }
    }

    return 0;
}
